# 0_イントロダクション

<p style='text-align: right;'> &copy; 20220112 by Takanori Shima </p>

## 1. EC2 の紹介

参考)

AWSは `Amazon Web Service`の略で Amazonが提供するクラウドコンピューティング環境である。

似たようなサービスにAzure(Microsoft)やGoogle Cloud(Google)もあるが、AWSはその中でも高いシェアを誇り、圧倒的な人気を持っている。

もともとは Amazon社内で使っていた社内システムに起源をもつ。

`EC2`とは、Amazon Web Service が提供している仮想サーバー構築サービス。

`Elastic Compute Cloud`の略で日本語に直すと、`柔軟に構築できるコンピュータクラウド環境`のこと。

これまでデータセンターで物理的なサーバーの構築を行っていたのが、Web上から数クリックで仮想サーバーを構築することができるので、業務の効率化を達成することができる。

また、継続利用時に起こりがちなスペック不足やディスク容量問題への対処も容易なコンピューティングキャパシティーであるため、長期的な運用も視野に入れることができる。

仮想サーバは `インスタンス`という単位で起動することでできる。 

インスタンスを最初の使う時には、初期設定で使用するOSとして Linux/Windows/MacOSなどを選択することができるが、無料枠で使用できるのは Amazon Linux2 のみ。

自由なソフトをインストールすることができ、アプリをデプロイしてインターネットに公開することができる。

EC２インスタンス環境にアクセスするには　SSHキーを利用する。

EC2の代表的なメリットは以下の通り。

```
1. 構築にかかる時間が短縮できる
2. 冗長化が簡単にできる
3. スペックの変更が柔軟に対応できる（Elastic）
4. 関連するサービスがたくさん存在するため、それらを組み合わせてカスタマイズのバラエティが広い
5. ネット情報などのリソースが多い
```

EC2の料金体系
```
- オンデマンドインスタンス
　　サーバーを立ち上げている時間によって料金が発生する
- リザーブドインスタンス
　　あらかじめ稼働期間を決めておき、先支払いする
- スポットインスタンス
　　AWS上にすでに存在し放置されているインスタンスを格安利用料で使う
```

EC2の関連サービス
```
- イメージ
　　サーバーのイメージを保管しておく
- EBS（Elastic Block Store）
    サーバー上に保存したデータを保管しておく
- Elastic IP
    固定IPを作成する
- ロードバランンシング
    負荷分散
-     
```

## 2. EC2での環境構築手順

```
1. EC2インスタンスの起動
2. SSHキーペア（秘密鍵、公開鍵）が自動作成される
3. ローカル環境から 秘密鍵を使って SSH接続してEC2インスタンスの中に入り込む
4. PHP/MySQL/Apach/Git/SSH/Conposerなどのソフトをインストールする
5. PEM形式のSSHキーペアを新規作成
6. GithubのDeployキーに新しく作成した公開鍵を登録
7. Githubリポジトリからアプリをcloneする
8. Apacheの設定変更
9. Laravelアプリの環境設定
10. アプリケーションキーの設定
11. マイグレーション
12. ブラウザからHTTPアクセス
```

## 3. CircleCIからEC2へ自動デプロイする手順
```
1. 新しく作った秘密鍵をCircleCIのSSHキーに登録
2. .circleci/.config.yml ファイルの編集
3. Githubへpush
```

## 4. HTTPS(SSL)化、固定IPの付与、DNSを使ったドメインの割り付け